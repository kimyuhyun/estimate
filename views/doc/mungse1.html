<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<!-- <meta name="viewport" content="width=1200, initial-scale=1, shrink-to-fit=no"> -->

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
<link href="/stylesheets/doc.css" rel="stylesheet">

<body class="p-1">
<%
    if (my.FILENAME0 != '') {
%>
    <div style="position: absolute; top: 60px; right: 10px;">
        <img src="<%=my.FILENAME0%>" height="40"/>
    </div>
<%
    }
%>



    <table class="tax_table" cellspacing="0" cellpadding="0">
        <tr>
            <td colspan="9">
                <table cellspacing="0" cellpadding="0">
                    <tr>
                        <th width="80" class="LineRight">거래일자</th>
                        <td class="LineRight text-center"><%=your.EDATE%></td>
                        <th class="LineRight d-flex flex-row align-items-center justify-content-center">
                            <h3 class="mb-0">거 래 명 세 표</h3>(공급받는자 보관용)
                        </th>
                        <th width="80" class="LineRight">일련번호</th>
                        <td class="text-center"><%=my.docNum%></td>

                    </tr>
                </table>
            </td>
        </tr>

        <tr>
            <td colspan="9" class="LineTop">
                <table cellspacing="0" cellpadding="0">
                    <tr>
                        <td width="50%">
                            <table>
                                <tr>
                                    <th rowspan="4" class="LineRight" width=20>공<br>급<br>받<br>는<br>자</th>
                                    <th class="LineRight" style="line-height: 12px;">등록<br>번호</th>
                                    <td colspan="4" class="LineRight text-center"><%=your.CNUM%></td>
                                </tr>

                                <tr class="LineTop">
                                    <th width=30 height=26 class="LineRight">상호</th>
                                    <td class="LineRight ps-1"><%=your.COMPANY%></td>
                                    <th width=30 class="LineRight">성명</td>
                                    <td class="LineRight ps-1"><%=your.NAME1%></td>
                                </tr>

                                <tr class="LineTop">
                                    <th width=30 height=26 class="LineRight">주소</th>
                                    <td colspan="3" class="LineRight ps-1"><%=your.ADDR1%> <%=your.ADDR2%></td>
                                </tr>

                                <tr class="LineTop">
                                    <th width=30 height=26 class="LineRight">TEL</th>
                                    <td class="LineRight ps-1"><%=your.TEL%></td>
                                    <th width=30 class="LineRight">FAX</th>
                                    <td class="LineRight ps-1"><%=your.FAX%></td>
                                </tr>

                            </table>
                        </td>
                        <td valign="top">
                            <table>
                                <tr>
                                    <th rowspan="4" class="LineRight" width=20>공<br>급<br>자</th>
                                    <th class="LineRight" style="line-height: 12px;">등록<br>번호</th>
                                    <td colspan="4" class=" text-center"><%=my.CNUM%></td>
                                </tr>
                                <tr class="LineTop">
                                    <th width=30 height=26 class="LineRight">상호</th>
                                    <td class="LineRight ps-1"><%=my.COMPANY%></td>
                                    <th width=30 class="LineRight">성명</td>
                                    <td class="ps-1"><%=my.NAME1%></td>
                                </tr>
                                <tr class="LineTop">
                                    <th width=30 height=26 class="LineRight">주소</th>
                                    <td colspan="3" class="ps-1"><%=my.ADDR1%> <%=my.ADDR2%></td>
                                </tr>
                                <tr class="LineTop">
                                    <th width=30 height=26 class="LineRight">TEL</th>
                                    <td class="LineRight ps-1"><%=my.TEL%></td>
                                    <th width=30 class="LineRight">FAX</th>
                                    <td class="ps-1"><%=my.FAX%></td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr class="LineTop2" style="height: 24px; background: #ecedff;">
            <th class="LineRight">No.</th>
            <th class="LineRight">품명</th>
            <th class="LineRight">규격</th>
            <th class="LineRight">단위</th>
            <th class="LineRight">수량</th>
            <th class="LineRight">단가</th>
            <th class="LineRight">공급가액</th>
            <th class="LineRight">세액</th>
            <th>합계</th>
        </tr>

<%
    var priceSum = 0;
    var taxSum = 0;
    var i = 0;
    var bg = "";
    for (obj of list) {
        i++;

        if ((i % 2) == 0) {
            bg = "#ecedff";
        } else {
            bg = "#fff";
        }
%>
        <tr class="LineTop" style="height: 24px; background: <%=bg%>;">
            <td class="LineRight text-center"><%=i%></td>
            <td class="LineRight ps-1"><%=obj.NAME1%></td>
            <td class="LineRight ps-1"><%=obj.GUKUK%></td>
            <td class="LineRight text-center"><%=obj.UNIT%></td>
            <td class="LineRight text-center"><%=obj.QTY.toLocaleString()%></td>
            <td class="LineRight pe-1 text-end"><%=obj.DANGA.toLocaleString()%></td>
            <td class="LineRight pe-1 text-end"><%=obj.PRICE.toLocaleString()%></td>
            <td class="LineRight pe-1 text-end"><%=obj.TAX.toLocaleString()%></td>
            <td class="pe-1 text-end"><%=(obj.PRICE + obj.TAX).toLocaleString()%></td>
        </tr>
<%
        priceSum = priceSum + obj.PRICE;
        taxSum = taxSum + obj.TAX;
    }
    var gap = 34 - i;

    if (i > 0) {
        for (j=0; j < gap; j++) {
            if ((j % 2) == 0) {
                bg = "#ecedff";
            } else {
                bg = "#fff";
            }

%>
        <tr class="LineTop" style="height: 24px; background: <%=bg%>;">
            <td align="center" class="LineRight"></td>
            <td class="LineRight"></td>
            <td class="LineRight"></td>
            <td class="LineRight"></td>
            <td class="LineRight"></td>
            <td class="LineRight"></td>
            <td class="LineRight"></td>
            <td class="LineRight"></td>
            <td class="LineRight"></td>
        </tr>
<%
        }
    }
%>
        <tr class="LineTop2">
            <td colspan="9">
                <table>
                    <tr>
                        <th width="80" height="30" class="LineRight">공급가액</th>
                        <td width="120" class="text-end LineRight pe-2"><b><%=priceSum.toLocaleString()%></b></td>
                        <th width="80" class="LineRight">세액</th>
                        <td width="100" class="text-end LineRight pe-2"><b><%=taxSum.toLocaleString()%></b></td>
                        <th width="80" class="LineRight">합계</th>
                        <td class="text-end pe-2"><b><%=(priceSum + taxSum).toLocaleString()%></b></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</body>
</html>
