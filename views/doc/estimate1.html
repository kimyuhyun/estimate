<html lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<!-- <meta name="viewport" content="width=1200, initial-scale=1, shrink-to-fit=no"> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">

<style>
table { font-size: 14px; }
</style>

<script src="/javascripts/textFit.js"></script>

<body class="p-1">
    <div style="position: absolute; top: 0px; left: 0px;">
        <img src="<%=my.FILENAME1%>" height="50"/>
    </div>

    <div style="position: absolute; top: 140px; left: 750px;">
        <img src="<%=my.FILENAME0%>" height="40"/>
    </div>

    <table cellspacing="0" cellpadding="0" class="w-100" style="font-size: 14px;">
        <tr><td colspan="2" class="text-center"><b style="font-size: 50px;">견&nbsp;&nbsp;&nbsp;적&nbsp;&nbsp;&nbsp;서</b></td></tr>
        <tr><td colspan="2" style="border-bottom: 1px solid #000;">No. <%=my.docNum%></td></tr>

        <tr>
            <td style="min-width: 500px;" valign="top">
                <h4 class="mt-3"><%=your.COMPANY%> 귀중</h4>
                <table>
                    <tr>
                        <th width="60" class="d-flex justify-content-between">
                            <div>견</div>
                            <div>적</div>
                            <div>일</div>
                        </th>
                        <td class="px-1"></td>
                        <td><%=your.EDATE%></td>
                    </tr>
                    <tr>
                        <th class="d-flex justify-content-between">
                            <div>납</div>
                            <div>기</div>
                            <div>일</div>
                        </th>
                        <td></td>
                        <td><%=your.DLV%></td>
                    </tr>

                    <tr>
                        <th class="d-flex justify-content-between">
                            <div>유</div>
                            <div>효</div>
                            <div>일</div>
                        </th>
                        <td></td>
                        <td><%=your.AVA%></td>
                    </tr>

                    <tr>
                        <th class="d-flex justify-content-between">
                            <div>견</div>
                            <div>적</div>
                            <div>내</div>
                            <div>용</div>
                        </th>
                        <td></td>
                        <td><%=your.CONTENT%></td>
                    </tr>

                    <tr>
                        <th class="d-flex justify-content-between">
                            <div>참</div>
                            <div>조</div>
                        </th>
                        <td></td>
                        <td><%=your.REFER%></td>
                    </tr>

                    <tr>
                        <th class="d-flex justify-content-between">
                            <div>전</div>
                            <div>화</div>
                            <div>번</div>
                            <div>호</div>
                        </th>
                        <td></td>
                        <td><%=your.TEL%></td>
                    </tr>
                    <tr>
                        <th class="d-flex justify-content-between">
                            <div>팩</div>
                            <div>스</div>
                            <div>번</div>
                            <div>호</div>
                        </th>
                        <td></td>
                        <td><%=your.FAX%></td>
                    </tr>
                    <tr>
                        <th class="d-flex justify-content-between">
                            <div>이</div>
                            <div>메</div>
                            <div>일</div>
                        </th>
                        <td></td>
                        <td><%=your.EMAIL%></td>
                    </tr>
                </table>
            </td>
            <td style="min-width: 500px;">
                <h4 class="mt-3"><%=my.COMPANY%></h4>
                <table>
                    <tr>
                        <th width="60" class="d-flex justify-content-between">
                            <div>사</div>
                            <div>업</div>
                            <div>자</div>
                            <div>번</div>
                            <div>호</div>
                        </th>
                        <td class="px-1"></td>
                        <td><%=my.CNUM%></td>
                    </tr>
                    <tr>
                        <th class="d-flex justify-content-between">
                            <div>대</div>
                            <div>표</div>
                        </th>
                        <td></td>
                        <td><%=my.NAME1%></td>
                    </tr>
                    <tr>
                        <th class="d-flex justify-content-between">
                            <div>업</div>
                            <div>태</div>
                        </th>
                        <td></td>
                        <td><%=my.UPTAE%></td>
                    </tr>
                    <tr>
                        <th class="d-flex justify-content-between">
                            <div>종</div>
                            <div>목</div>
                        </th>
                        <td></td>
                        <td><%=my.JONGMOK%></td>
                    </tr>
                    <tr>
                        <th class="d-flex justify-content-between">
                            <div>연</div>
                            <div>락</div>
                            <div>처</div>
                        </th>
                        <td></td>
                        <td>
                            <%=my.HP==''?'':'M: '+my.HP%>
                            <%=my.TEL==''?'':'T: '+my.TEL%>
                            <%=my.FAX==''?'':'F: '+my.FAX%>
                            <%=my.EMAIL==''?'':'E: '+my.EMAIL%>
                        </td>
                    </tr>
                    <tr>
                        <th class="d-flex justify-content-between">
                            <div>주</div>
                            <div>소</div>
                        </th>
                        <td></td>
                        <td><%=my.ADDR1%> <%=my.ADDR2%></td>
                    </tr>
                </table>
            </td>
        </tr>

        <tr><td colspan="2" style="border-bottom: 1px solid #000; height: 30px;"></td></tr>
        <tr style="height: 50px; ">
            <td><h5>견적금액 <%=your.IS_VAT==0?'(VAT포함)':'(VAT별도)'%></h5></td>
            <td class="text-end"><h5>일금 <%=my.HAN_PRICE%> 원정 (￦<%=my.TTL_PRICE.toLocaleString()%>)</h5></td>
        </tr>

        <tr>
            <td colspan="2">
                <table class="table table-striped">
                    <tr class="text-center">
                        <th width="50">No.</th>
                        <th>품명</th>
                        <th width="100">단위</th>
                        <th width="50">수량</th>
                        <th width="120">단가</th>
                        <th width="120">공급가액</th>
                        <th width="100">세액</th>
                        <th width="120">합계</th>
                    </tr>
<%
    var priceSum = 0;
    var taxSum = 0;
    var i = 0;
    for (obj of list) {
        i++;
%>
                    <tr>
                        <td align="center"><%=i%></td>
                        <td><%=obj.NAME1%></td>
                        <td align="center"><%=obj.UNIT%></td>
                        <td class="text-center"><%=obj.QTY.toLocaleString()%></td>
                        <td class="text-end"><%=obj.DANGA.toLocaleString()%></td>
                        <td class="text-end"><%=obj.PRICE.toLocaleString()%></td>
                        <td class="text-end"><%=obj.TAX.toLocaleString()%></td>
                        <td class="text-end"><%=(obj.PRICE + obj.TAX).toLocaleString()%></td>
                    </tr>
<%
        priceSum = priceSum + obj.PRICE;
        taxSum = taxSum + obj.TAX;
    }
%>
                    <tr>
                        <td align="center" colspan="5"><b>합계</b></td>
                        <td class="text-end"><b><%=priceSum.toLocaleString()%></b></td>
                        <td class="text-end"><b><%=taxSum.toLocaleString()%></b></td>
                        <td class="text-end"><b><%=(priceSum + taxSum).toLocaleString()%></b></td>
                    </tr>



                </table>

            </td>
        </tr>
    </table>
</body>
</html>

<script>
setTimeout(function() {
    textFit(document.getElementsByClassName('box'), {minFontSize:10, maxFontSize: 50});
}, 100);

</script>
